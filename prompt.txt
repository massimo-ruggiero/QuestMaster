You are a senior AI agent that repairs and validates PDDL planning files.
You always return *only* syntactically correct PDDL, consistent with the
narrative lore supplied.
---
‚ú¶ INPUTS YOU RECEIVE
  ‚Ä¢ <domain>  ........ current domain.pddl (may be invalid)
  ‚Ä¢ <problem> ........ current problem.pddl (may be invalid)
  ‚Ä¢ <error>   ........ latest planner/validator error message
  ‚Ä¢ <lore>    ........ world-building constraints and quest design rules
---
‚ú¶ WHAT YOU MUST DO
  1. Read the error first; locate the precise cause.
  2. Cross-check proposed fixes against the lore (goals, actors, items,
    branching factor, depth limits, narrative consistency).
  3. Apply the **minimal** set of changes that (a) eliminates the error and
    (b) preserves original design intent.
  4. Run an internal sanity pass: goals reachable, actions well-typed,
    no orphan predicates, every object declared.
---
‚ú¶ HARD CONSTRAINTS
  ‚Ä¢ **Do NOT insert any comments inside the returned PDDL.**  
    (No lines starting with ‚Äú;‚Äù or any other comment syntax.)
  ‚Ä¢ Do not include error messages, explanations, or lore excerpts.
---
‚ú¶ OUTPUT FORMAT ‚Äî STRICT
  Return exactly two blocks, nothing else:
    <domain>
    ‚Ä¶full corrected domain PDDL‚Ä¶
    </domain>
    <problem>
    ‚Ä¶full corrected problem PDDL‚Ä¶
    </problem>

Planner error:
""""        
Parsing...
Parsing domain
	->Parsing axiom/action entry #4
	->Parsing action #4
	->Parsing action 'negotiate-with-faction'
	->Parsing precondition
	->Parsing condition
	->Parsing literal
Undefined object
Got: fracturedcourt
translate exit code: 31

Driver aborting after translate
INFO     Planner time: 0.05s
""""       
Lore document:
""""
# üó∫Ô∏è Lore Document: *The Emberfall Conspiracy*

## üìñ Quest Description

In the twilight-ruled kingdom of **Emberfall**, a creeping shadow spreads from the **Ashspire Mountains**, corrupting nature and minds alike. Rumors speak of an ancient artifact ‚Äî the **Heart of Cinders** ‚Äî sealed away centuries ago by the Pyromancers' Order, now lost to legend.

You are a **Seeker**, trained in both lore and blade, tasked by the enigmatic **Council of Embers** to retrieve the artifact before the corruption reaches the capital, **Elarion**. Along the way, you must navigate treacherous political factions, ancient ruins warped by dark fire, and a prophecy that might name you either savior or destroyer.

### Obstacles Include:
- **The Fractured Court**: Competing noble houses offering aid ‚Äî at a price.
- **Ashborn Creatures**: Twisted wildlife and former humans consumed by flame.
- **False Prophets**: Cults who believe the Heart should remain buried ‚Äî or used.
- **Moral Choices**: The artifact‚Äôs power can purify or destroy. Which will you choose?

## üåø World Context

Emberfall is a volcanic region rich in elemental energy. Magic here is volatile and deeply tied to emotion and will. The balance between light and dark is fragile, and ancient powers still linger beneath the scorched earth.

---

## üîÄ Branching Factor

- **Minimum Actions per Narrative State**: 2  
- **Maximum Actions per Narrative State**: 5  

Each key decision point provides multiple narrative options, with at least two meaningful choices and sometimes as many as five. These branches can influence alliances, unlock unique challenges, or alter the moral tone of the ending.

---

## üß≠ Depth Constraints

- **Minimum Steps to Reach Goal**: 6  
- **Maximum Steps to Reach Goal**: 12 
"""" 
Original domain:
""""
(define (domain emberfall-conspiracy)
  (:requirements :strips :typing :equality)
  (:types
    location item faction creature
  )

  (:constants
    elarion whisperingwoods shadowfen pyromancerruins - location
    
    ashborn - creature
  )

  (:predicates
    (at ?l - location)
    (has-item ?i - item)
    (path ?from - location ?to - location)
    (faction-is-at ?f - faction ?l - location)
    (creatures-are-at ?c - creature ?l - location)
    (artifact-is-at ?i - item ?l - location)
    (faction-is-neutralized ?f - faction)
    (creatures-are-defeated ?c - creature)
    (path-to-artifact-known)
    (quest-is-active)
    (faction-obstacle-cleared)
    (creature-obstacle-cleared)
  )

  (:action accept-quest
    :parameters ()
    :precondition (and
      (at elarion)
      (not (quest-is-active))
    )
    :effect (and
      (quest-is-active)
    )
  )

  (:action travel
    :parameters (?from - location ?to - location)
    :precondition (and
      (at ?from)
      (path ?from ?to)
      (not (= ?to pyromancerruins))
    )
    :effect (and
      (not (at ?from))
      (at ?to)
    )
  )

  (:action travel-to-ruins
    :parameters (?from - location)
    :precondition (and
      (at ?from)
      (path ?from pyromancerruins)
      (path-to-artifact-known)
    )
    :effect (and
      (not (at ?from))
      (at pyromancerruins)
    )
  )

  (:action negotiate-with-faction
    :parameters ()
    :precondition (and
      (at whisperingwoods)
      (quest-is-active)
      (faction-is-at fracturedcourt whisperingwoods)
    )
    :effect (and
      (faction-is-neutralized fracturedcourt)
      (faction-obstacle-cleared)
      (not (faction-is-at fracturedcourt whisperingwoods))
    )
  )

  (:action intimidate-faction
    :parameters ()
    :precondition (and
      (at whisperingwoods)
      (quest-is-active)
      (faction-is-at fracturedcourt whisperingwoods)
    )
    :effect (and
      (faction-is-neutralized fracturedcourt)
      (faction-obstacle-cleared)
      (not (faction-is-at fracturedcourt whisperingwoods))
    )
  )

  (:action fight-creatures
    :parameters ()
    :precondition (and
      (at shadowfen)
      (quest-is-active)
      (creatures-are-at ashborn shadowfen)
    )
    :effect (and
      (creatures-are-defeated ashborn)
      (creature-obstacle-cleared)
      (not (creatures-are-at ashborn shadowfen))
    )
  )

  (:action sneak-past-creatures
    :parameters ()
    :precondition (and
      (at shadowfen)
      (quest-is-active)
      (creatures-are-at ashborn shadowfen)
    )
    :effect (and
      (creatures-are-defeated ashborn)
      (creature-obstacle-cleared)
      (not (creatures-are-at ashborn shadowfen))
    )
  )

  (:action learn-artifact-location
    :parameters ()
    :precondition (and
      (faction-obstacle-cleared)
      (creature-obstacle-cleared)
    )
    :effect (and
      (path-to-artifact-known)
    )
  )

  (:action retrieve-artifact
    :parameters ()
    :precondition (and
      (at pyromancerruins)
      (artifact-is-at heartofcinders pyromancerruins)
    )
    :effect (and
      (has-item heartofcinders)
      (not (artifact-is-at heartofcinders pyromancerruins))
    )
  )
)
""""
Original problem:
""""
(define (problem emberfall-quest)
  (:domain emberfall-conspiracy)
  (:init
    (at elarion)
    (faction-is-at fracturedcourt whisperingwoods)
    (creatures-are-at ashborn shadowfen)
    (artifact-is-at heartofcinders pyromancerruins)
    (path elarion whisperingwoods)
    (path whisperingwoods elarion)
    (path elarion shadowfen)
    (path shadowfen elarion)
    (path whisperingwoods shadowfen)
    (path shadowfen whisperingwoods)
    (path shadowfen pyromancerruins)
    (path pyromancerruins shadowfen)
    (path whisperingwoods pyromancerruins)
    (path pyromancerruins whisperingwoods)
  )
  (:goal (and
    (has-item heartofcinders)
    (at elarion)
  ))
)
"""" 
